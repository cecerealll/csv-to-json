<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <input type="file" id='csv'>
    <button>convert first row as heading</button>
    <!-- <button>convert first column as heading</button> -->
    
    <p></p>
    <!-- <a href=""></a> -->

    <script>
        
        const selectedFile = document.getElementById('csv');
        const convert = document.querySelector('button');
        let fileToRead;

        selectedFile.addEventListener('change', function(){
            fileToRead = selectedFile.files[0];
            // console.log(typeof fileToRead);
           
        });
        
     

        convert.addEventListener('click', function readFile(){
            // console.log('hi');
            // console.log(fileToRead);
            const scan = new FileReader();
            scan.readAsText(fileToRead);
            scan.onload = function(e) {
                const fileString = e.target.result.replace(/\n/ig, '');

                // to split the csv into diff rows
                const fileRows = fileString.split(`\r`);
                console.log(fileRows);
                // split individual words
                const fileCol = fileRows.map(col => col.split(','));

                // get rid of the first empty string
                fileCol[0].shift();

                // the animals array
                const firstRow = fileCol[0];
                console.log(fileCol);


                const obj = firstRow.reduce((acc, curr)=> {
                    acc[curr] = {
                    };

                    for(let i = 1; i<fileCol.length; i++){
                        console.log(fileCol[i]);
                        console.log(fileCol[i][1])
                        acc[curr][fileCol[i][0]] = fileCol[i][i];
                    }
                    return acc;
                    
                }, {});
                console.log(JSON.stringify(obj));
                const jsonObj = JSON.stringify(obj, null, 2);
                document.querySelector('p').innerHTML = jsonObj;
            }

        })

        



        
        


        



        // convert the csv file into a JSON file
        // this is essentially what we want from the csv
        // {
        //     "Dog": {
        //         "Loud": "yes",
        //         "Dirty": "yes",
        //         "Fluffy": "yes"
        //     },
        //     "Cat": {
        //         "Loud": "no",
        //         "Dirty": "no",
        //         "Fluffy": "yes"
        //     },
        //     "Bird": {
        //         "Loud": "yes",
        //         "Dirty": "no",
        //         "Fluffy": "no"
        //     },
        //     "Lizard": {
        //         "Loud": "no",
        //         "Dirty": "no",
        //         "Fluffy": "no"
        //     }
        // }

    </script>
</body>
</html>